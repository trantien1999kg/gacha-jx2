(()=>{const $=document.querySelector.bind(document);let timer=8e3,isRotating=!1,currentRotate=0;const wheel=$(".wheel"),welcom=$(".text__header__wheel"),innerWheel=$(".inner__wheel");let fullname=$("#fullname");const btnApply=$(".btn__apply"),btnStart=$(".btn__start"),box_hidden=$(".box__info__wheel"),msg=$(".msg"),listGift=data,size=listGift.length,rotate=360/size,skewY=90-rotate,renderItem=()=>{listGift.forEach((item,index)=>{const itemGift=document.createElement("li");itemGift.style.transform=`\n                rotate(${rotate*index}deg)\n                skewY(-${skewY}deg)\n            `,itemGift.innerHTML=`\n                <p class="text-item ${index%2==0&&"even"}" \n                    style="transform:skewY(${skewY}deg)\n                    rotate(${rotate/2}deg)"\n                >\n            <b>       <img src="upload/baiviet/${item.photo}" class="imgspin" alt="${item.name}" />\n  ${item.name}</b>\n                </p>\n            `,wheel.appendChild(itemGift)})},rotateWheel=(currentRotate,index)=>{wheel.style.transform=`rotate(${currentRotate-index*rotate-rotate/2}deg)`},getGift=randomNumber=>{let currentPercent=0,list=[];return listGift.forEach((item,index)=>{currentPercent+=item.percent,randomNumber<=currentPercent&&list.push({...item,index:index})}),list[0]},showPopup=(name,photo,lucky)=>{let isphoto,isLucky="1"!=lucky?` <div class="inner__photo">\n                ${""!=photo&&`<div class="image__prize">\n                <img src="upload/baiviet/${photo}" alt="${name}" />\n            </div>`}\n                <div class="name__prize">${name}</div>\n            </div>`:"";innerWheel.innerHTML=`\n\n            <div class="popup__overlay">\n                <div class="popup__info">\n                   ${isLucky}\n                    <div class="btn__default" onclick='window.location.href=""'>\n                        Xác nhận\n                    </div>\n                    \n                </div>\n\n            </div>\n\n        `},showText=id=>{setTimeout(()=>{isRotating=!1,pauseAudio(),jQuery.ajax({url:"ajax/saveWheel.php",type:"POST",data:{id:id,name:fullname.value},dataType:"json",success:function(data){fullname.value="",welcom.innerHTML=`${data.slogan}`,playAudio1(),showPopup(data.name,data.photo,data.lucky)}})},8e3)},pauseAudio=()=>{var audio;$("#audio").pause()},playAudio=()=>{var audio=$("#audio");audio.currentTime=0,audio.play()},playAudio1=()=>{var audio=$("#audio");audio.currentTime=12,audio.play()},start=()=>{isRotating=!0;const random=Math.random(),gift=getGift(random);currentRotate+=3600,rotateWheel(currentRotate,gift.index),playAudio(),showText(gift.id)};btnStart.addEventListener("click",()=>{if(btnStart.classList.contains("disabled"))return alert("Bạn chưa đồng ý xác nhận, vui lòng xác nhận để thực hiện quay thưởng!"),!1;!isRotating&&start()}),btnApply.addEventListener("click",()=>{if(""==fullname.value)return alert("Bạn chưa nhập họ tên, vui lòng nhập họ tên để tham gia quay thưởng"),fullname.focus(),!1;btnStart.classList.remove("disabled"),btnApply.classList.add("disabled"),box_hidden.style.display="none"}),renderItem()})();